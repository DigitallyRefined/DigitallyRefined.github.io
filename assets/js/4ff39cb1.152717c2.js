"use strict";(self.webpackChunkdigitally_refined=self.webpackChunkdigitally_refined||[]).push([[767],{4067:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>o,default:()=>p,frontMatter:()=>d,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"guides/2023-05-14-IKEA-VINDSTYRKA","title":"IKEA VINDSTYRKA","description":"The IKEA VINDSTYRKA an relatively inexpensive air quality monitor $49/\xa335 that was released in April 2023.","source":"@site/docs/guides/2023-05-14-IKEA-VINDSTYRKA.mdx","sourceDirName":"guides","slug":"/guides/IKEA-VINDSTYRKA","permalink":"/guides/IKEA-VINDSTYRKA","draft":false,"unlisted":false,"editUrl":"https://github.com/DigitallyRefined/DigitallyRefined.github.io/tree/main/docs/guides/2023-05-14-IKEA-VINDSTYRKA.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"slug":"/guides/IKEA-VINDSTYRKA","last_update":{"date":"2023-05-15T00:00:00.000Z"}},"sidebar":"tutorialSidebar","previous":{"title":"Tailscale & Headscale","permalink":"/guides/Tailscale-Headscale-setup"}}');var a=i(4848),t=i(8453),r=i(4252),l=i(7833);const d={sidebar_position:1,slug:"/guides/IKEA-VINDSTYRKA",last_update:{date:new Date("2023-05-15T00:00:00.000Z")}},o="IKEA VINDSTYRKA",h={},c=[{value:"Video",id:"video",level:2},{value:"Features",id:"features",level:2},{value:"Pros",id:"pros",level:2},{value:"Cons",id:"cons",level:2},{value:"Home Assistant ZHA integration",id:"home-assistant-zha-integration",level:2},{value:"Applying the patch manually",id:"applying-the-patch-manually",level:3},{value:"Uninstalling the patch",id:"uninstalling-the-patch",level:3}];function u(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"ikea-vindstyrka",children:"IKEA VINDSTYRKA"})}),"\n",(0,a.jsx)(n.p,{children:"The IKEA VINDSTYRKA an relatively inexpensive air quality monitor $49/\xa335 that was released in April 2023."}),"\n","\n",(0,a.jsx)(r.A,{toc:c}),"\n",(0,a.jsx)(n.h2,{id:"video",children:"Video"}),"\n","\n",(0,a.jsx)(l.A,{id:"EvjTHlPT9zM",title:"IKEA VINDSTYRKA Review & Pairing to Home Assistant",poster:"maxresdefault",webp:!0}),"\n",(0,a.jsx)("a",{href:"https://youtu.be/EvjTHlPT9zM",children:"Watch on YouTube"}),"\n",(0,a.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"PM2.5"}),"\n",(0,a.jsx)(n.li,{children:"tVOC"}),"\n",(0,a.jsx)(n.li,{children:"Temperature"}),"\n",(0,a.jsx)(n.li,{children:"Humidity"}),"\n",(0,a.jsx)(n.li,{children:"Air quality icons"}),"\n",(0,a.jsx)(n.li,{children:"Zigbee radio"}),"\n",(0,a.jsx)(n.li,{children:"USB-C"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"pros",children:"Pros"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Relatively inexpensive way to add air quality, temperature & humidity data to your smart home"}),"\n",(0,a.jsx)(n.li,{children:"Can perform automatons based on data, such as turning on/off air purifiers, air conditioning and dehumidifiers or even humidifiers"}),"\n",(0,a.jsx)(n.li,{children:"Configurable backlight brightness & always on or auto off"}),"\n",(0,a.jsx)(n.li,{children:"Works with Home Assistant via Zigbee"}),"\n",(0,a.jsx)(n.li,{children:"USB-C powered"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"cons",children:"Cons"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"No time or date on display (LCD limitation)"}),"\n",(0,a.jsx)(n.li,{children:"Fan does make small amount of noise"}),"\n",(0,a.jsx)(n.li,{children:"Temperature lacks decimal places (precision)"}),"\n",(0,a.jsx)(n.li,{children:"Getting the tVOC value via ZHA requires a bit more setup"}),"\n",(0,a.jsx)(n.li,{children:"Only available in white"}),"\n",(0,a.jsx)(n.li,{children:"No battery"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"home-assistant-zha-integration",children:"Home Assistant ZHA integration"}),"\n",(0,a.jsxs)(n.p,{children:["Currently if you're using the default ",(0,a.jsx)(n.a,{href:"https://www.home-assistant.io/integrations/zha/",children:"ZHA integration"})," for your Zigbee coordinator, the tVOC sensor wont be available in Home Assistant. However, tVOC is available via the ",(0,a.jsx)(n.a,{href:"https://github.com/zigbee2mqtt/hassio-zigbee2mqtt#installation",children:"Zigbee2MQTT plug-in"})," (so if you're using Zigbee2MQTT there's no need to apply the patch below)."]}),"\n",(0,a.jsxs)(n.p,{children:["See also: ",(0,a.jsx)(n.a,{href:"https://youtu.be/RWzzNe5gm5s",children:"differences between ZHA and Zigbee2MQTT"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"There are currently 2 GitHub pull requests to enable it, however at the time of publishing they weren't merged:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/zigpy/zha-device-handlers/pull/2315",children:"Add support for IKEA VINDSTYRKA Air quality Sensor #2315"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/home-assistant/core/pull/90616",children:'Add support for "VOC Index" sensor entity in ZHA #90616'})}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"applying-the-patch-manually",children:"Applying the patch manually"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"config/configuration.yaml"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yml",children:"zha:\n custom_quirks_path: /share/zhaquirks/\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"share/ikea-vindstyrka/patch-zha-sensor.sh"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'#!/usr/bin/env bash\n\nSCRIPT_DIR=$( cd -- "$( dirname -- "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )\nCONFIG_DIR=$(realpath $SCRIPT_DIR/../../config)\nZHA_DIR=$CONFIG_DIR/custom_components/zha\nZHAQUIRKS_DIR=$(realpath $SCRIPT_DIR/../zhaquirks)\n\nmkdir -p $CONFIG_DIR/custom_components\n\nrm -fR $ZHA_DIR\ndocker cp homeassistant:/usr/src/homeassistant/homeassistant/components/zha $ZHA_DIR\ndocker cp homeassistant:/usr/local/lib/python3.10/site-packages/zhaquirks $ZHAQUIRKS_DIR\n\napk add patch\n\npatch -u -b $ZHA_DIR/sensor.py -i $SCRIPT_DIR/sensor.patch\npatch -u -b $ZHA_DIR/manifest.json -i $SCRIPT_DIR/version.patch\nwget https://raw.githubusercontent.com/zigpy/zha-device-handlers/8e568464caedab3bd7c7fedb2544da99987d05d0/zhaquirks/ikea/vindstyrka.py -P $ZHAQUIRKS_DIR/ikea\n\ndocker restart homeassistant\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"chmod +x share/ikea-vindstyrka/patch-zha-sensor.sh"})}),"\n",(0,a.jsxs)(n.p,{children:["Patches are based off the ",(0,a.jsx)(n.a,{href:"https://github.com/home-assistant/core/pull/90616.patch",children:'"VOC Index" pull request'})]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"share/ikea-vindstyrka/sensor.patch"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-diff",children:'--- sensor.py.orig\t2023-05-04 09:39:47.277383955 +0100\n+++ sensor.py\t2023-05-04 09:48:06.726541317 +0100\n@@ -700,6 +700,18 @@\n     _attr_native_unit_of_measurement = CONCENTRATION_PARTS_PER_BILLION\n \n \n+@MULTI_MATCH(cluster_handler_names="voc_index", stop_on_match_group="voc_index")\n+class VOCIndex(Sensor):\n+    """VOC Index sensor."""\n+\n+    SENSOR_ATTR = "measured_value"\n+    _attr_device_class: SensorDeviceClass = SensorDeviceClass.VOLATILE_ORGANIC_COMPOUNDS\n+    _attr_state_class: SensorStateClass = SensorStateClass.MEASUREMENT\n+    _attr_name: str = "VOC index"\n+    _decimals = 0\n+    _multiplier = 1\n+\n+\n @MULTI_MATCH(cluster_handler_names="pm25")\n class PM25(Sensor):\n     """Particulate Matter 2.5 microns or less sensor."""\n'})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.code,{children:"share/ikea-vindstyrka/version.patch"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-diff",children:'--- manifest.json\t2023-04-09 04:43:34.000000000 +0100\n+++ "manifest copy.json"\t2023-04-09 08:55:44.655664588 +0100\n@@ -1,6 +1,7 @@\n {\n   "domain": "zha",\n   "name": "Zigbee Home Automation",\n+  "version": "0.0.1-ikea-vindstyrka",\n   "after_dependencies": ["onboarding", "usb"],\n   "codeowners": ["@dmulcahey", "@adminiuga", "@puddly"],\n   "config_flow": true,\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Once the files have been copied over to your Home Assistant, run the patch script via:",(0,a.jsx)(n.br,{}),"\n",(0,a.jsx)(n.code,{children:"~/share/ikea-vindstyrka/patch-zha-sensor.sh"})]}),"\n",(0,a.jsx)(n.p,{children:"Note: each time Home Assistant updates you will need to rerun the script."}),"\n",(0,a.jsx)(n.h3,{id:"uninstalling-the-patch",children:"Uninstalling the patch"}),"\n",(0,a.jsxs)(n.p,{children:["Delete the ",(0,a.jsx)(n.code,{children:"zha.custom_quirks_path"})," in your configuration and remove following directories:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"config/custom_components/zha"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"share/ikea-vindstyrka"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"share/zhaquirks"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}}}]);